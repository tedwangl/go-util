# å·¥ä½œæµå¼•æ“Žé€‰æ‹©å»ºè®®

## å¿«é€Ÿå†³ç­–æ ‘

```
éœ€è¦å·¥ä½œæµå¼•æ“Žï¼Ÿ
    â”‚
    â”œâ”€ éœ€è¦ Web UIï¼Ÿ
    â”‚   â”‚
    â”‚   â”œâ”€ æ˜¯ â†’ ä¸ªäººä½¿ç”¨ï¼Ÿ
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€ æ˜¯ â†’ æŽ¨è Dagu â­â­â­â­â­
    â”‚   â”‚   â”‚
    â”‚   â”‚   â””â”€ å¦ â†’ æ•°æ®å·¥ç¨‹ï¼Ÿ
    â”‚   â”‚       â”‚
    â”‚   â”‚       â”œâ”€ æ˜¯ â†’ æŽ¨è Airflow â­â­â­â­
    â”‚   â”‚       â”‚
    â”‚   â”‚       â””â”€ å¦ â†’ æŽ¨è Temporal â­â­â­
    â”‚   â”‚
    â”‚   â””â”€ å¦ â†’ æŽ¨è devtool schedule â­â­â­â­â­
    â”‚
    â””â”€ ç®€å•ä»»åŠ¡ï¼Ÿ
        â”‚
        â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ Shell/Makefile â­â­â­â­â­
        â”‚
        â””â”€ å¦ â†’ é‡æ–°è¯„ä¼°éœ€æ±‚
```

## è¯¦ç»†å¯¹æ¯”

### 1. Daguï¼ˆæœ€æŽ¨èä¸ªäººä½¿ç”¨ï¼‰â­â­â­â­â­

**é€‚åˆåœºæ™¯**ï¼š
- âœ… ä¸ªäººé¡¹ç›®
- âœ… å°å›¢é˜Ÿ
- âœ… éœ€è¦ Web UI
- âœ… ç®€å•åˆ°ä¸­ç­‰å¤æ‚åº¦çš„å·¥ä½œæµ

**ä¼˜ç‚¹**ï¼š
- å•äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®‰è£…ç®€å•
- ç¾Žè§‚å®žç”¨çš„ Web UI
- YAML é…ç½®ï¼Œæ˜“äºŽç†è§£
- èµ„æºå ç”¨å°‘
- æ”¯æŒ DAGã€å®šæ—¶è°ƒåº¦ã€é‡è¯•

**ç¼ºç‚¹**ï¼š
- åŠŸèƒ½ä¸å¦‚ Airflow ä¸°å¯Œ
- ç¤¾åŒºç›¸å¯¹è¾ƒå°
- ä¸é€‚åˆå¤§è§„æ¨¡åˆ†å¸ƒå¼

**å®‰è£…**ï¼š
```bash
brew install dagu-org/brew/dagu
dagu start-all
# è®¿é—® http://localhost:8080
```

**ç¤ºä¾‹**ï¼š
```yaml
name: my-workflow
schedule: "0 1 * * *"
steps:
  - name: step1
    command: python script1.py
  - name: step2
    command: python script2.py
    depends: [step1]
```

---

### 2. Airflowï¼ˆæ•°æ®å·¥ç¨‹é¦–é€‰ï¼‰â­â­â­â­

**é€‚åˆåœºæ™¯**ï¼š
- âœ… æ•°æ®å·¥ç¨‹å›¢é˜Ÿ
- âœ… ETL/ELT ç®¡é“
- âœ… å¤æ‚çš„æ•°æ®å¤„ç†
- âœ… éœ€è¦ä¸°å¯Œçš„é›†æˆ

**ä¼˜ç‚¹**ï¼š
- åŠŸèƒ½å¼ºå¤§ï¼Œç”Ÿæ€ä¸°å¯Œ
- ä¼˜ç§€çš„ Web UI
- å¤§é‡çš„ Operators
- æˆç†Ÿç¨³å®šï¼Œç¤¾åŒºæ´»è·ƒ

**ç¼ºç‚¹**ï¼š
- éƒ¨ç½²å¤æ‚ï¼ˆéœ€è¦ Dockerï¼‰
- èµ„æºå ç”¨è¾ƒå¤§
- å­¦ä¹ æ›²çº¿ä¸­ç­‰
- å¯¹ä¸ªäººç”¨æˆ·æ¥è¯´æœ‰ç‚¹é‡

**å®‰è£…**ï¼š
```bash
cd workflow/airflow
docker-compose up -d
# è®¿é—® http://localhost:8080
# ç”¨æˆ·å/å¯†ç : airflow/airflow
```

---

### 3. Temporalï¼ˆå¾®æœåŠ¡ç¼–æŽ’ï¼‰â­â­â­

**é€‚åˆåœºæ™¯**ï¼š
- âœ… å¾®æœåŠ¡ç¼–æŽ’
- âœ… é•¿æ—¶é—´è¿è¡Œçš„ä¸šåŠ¡æµç¨‹
- âœ… éœ€è¦å¼ºä¸€è‡´æ€§
- âœ… å¤æ‚çš„è¡¥å¿é€»è¾‘

**ä¼˜ç‚¹**ï¼š
- äº‹ä»¶æº¯æºï¼Œå¯é æ€§é«˜
- æ”¯æŒå¤šè¯­è¨€
- è‡ªåŠ¨é‡è¯•å’ŒçŠ¶æ€ç®¡ç†
- é€‚åˆå¤æ‚ä¸šåŠ¡æµç¨‹

**ç¼ºç‚¹**ï¼š
- å­¦ä¹ æ›²çº¿é™¡å³­
- éƒ¨ç½²å¤æ‚
- Web UI åŠŸèƒ½åŸºç¡€
- å¯¹ä¸ªäººç”¨æˆ·æ¥è¯´è¿‡äºŽå¤æ‚

**å®‰è£…**ï¼š
```bash
cd workflow/temporal
docker-compose up -d
# è®¿é—® http://localhost:8088
```

---

### 4. devtool scheduleï¼ˆç®€å•å®šæ—¶ä»»åŠ¡ï¼‰â­â­â­â­â­

**é€‚åˆåœºæ™¯**ï¼š
- âœ… ç®€å•çš„å®šæ—¶ä»»åŠ¡
- âœ… ä¸éœ€è¦å¤æ‚ä¾èµ–
- âœ… å‘½ä»¤è¡Œæ“ä½œ
- âœ… è½»é‡çº§éœ€æ±‚

**ä¼˜ç‚¹**ï¼š
- æžå…¶ç®€å•
- å·²ç»é›†æˆåœ¨ä½ çš„å·¥å…·ä¸­
- æ— éœ€é¢å¤–éƒ¨ç½²
- èµ„æºå ç”¨æžå°‘

**ç¼ºç‚¹**ï¼š
- æ—  Web UI
- ä¸æ”¯æŒå¤æ‚çš„ä»»åŠ¡ä¾èµ–
- åŠŸèƒ½æœ‰é™

**ä½¿ç”¨**ï¼š
```bash
devtool add "python script.py" --schedule "0 1 * * *" --name task1
devtool list
devtool logs
```

---

## æŽ¨èæ–¹æ¡ˆ

### ä¸ªäººå¼€å‘è€…ï¼ˆä½ çš„æƒ…å†µï¼‰

**æŽ¨èç»„åˆ**ï¼š

1. **ç®€å•å®šæ—¶ä»»åŠ¡** â†’ devtool schedule
   ```bash
   devtool add "backup.sh" --schedule "@daily" --name backup
   ```

2. **éœ€è¦ Web UI çš„å·¥ä½œæµ** â†’ Dagu
   ```bash
   brew install dagu-org/brew/dagu
   dagu start-all
   ```

3. **ä¸´æ—¶è„šæœ¬** â†’ Makefile/Shell
   ```makefile
   pipeline: extract transform load
   ```

### å°å›¢é˜Ÿ

**æŽ¨è**ï¼šDagu æˆ– Airflow

- å¦‚æžœä¸»è¦åšæ•°æ®å¤„ç† â†’ Airflow
- å¦‚æžœæ˜¯é€šç”¨å·¥ä½œæµ â†’ Dagu

### ä¼ä¸šåº”ç”¨

**æŽ¨è**ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©

- æ•°æ®å·¥ç¨‹ â†’ Airflow
- å¾®æœåŠ¡ç¼–æŽ’ â†’ Temporal
- é€šç”¨å·¥ä½œæµ â†’ Airflow æˆ– Temporal

---

## åŠŸèƒ½å¯¹æ¯”è¡¨

| åŠŸèƒ½ | Dagu | Airflow | Temporal | devtool |
|------|------|---------|----------|---------|
| **Web UI** | â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | âŒ |
| **å®‰è£…éš¾åº¦** | â­ | â­â­â­ | â­â­â­â­ | â­ |
| **å­¦ä¹ æ›²çº¿** | â­â­ | â­â­â­ | â­â­â­â­ | â­ |
| **èµ„æºå ç”¨** | â­ | â­â­â­ | â­â­â­ | â­ |
| **DAG æ”¯æŒ** | âœ… | âœ… | âœ… | âŒ |
| **å®šæ—¶è°ƒåº¦** | âœ… | âœ… | âœ… | âœ… |
| **é‡è¯•æœºåˆ¶** | âœ… | âœ… | âœ… | âœ… |
| **å¹¶è¡Œæ‰§è¡Œ** | âœ… | âœ… | âœ… | âŒ |
| **åˆ†å¸ƒå¼** | âŒ | âœ… | âœ… | âŒ |
| **é€‚åˆä¸ªäºº** | â­â­â­â­â­ | â­â­â­ | â­â­ | â­â­â­â­â­ |

---

## å®žé™…ä½¿ç”¨å»ºè®®

### åœºæ™¯ 1ï¼šæ¯æ—¥æ•°æ®å¤‡ä»½

**æŽ¨è**ï¼šdevtool schedule
```bash
devtool add "backup.sh" --schedule "@daily" --name backup
```

### åœºæ™¯ 2ï¼šå¤šæ­¥éª¤æ•°æ®å¤„ç†

**æŽ¨è**ï¼šDagu
```yaml
name: data-pipeline
steps:
  - name: extract
    command: python extract.py
  - name: transform
    command: python transform.py
    depends: [extract]
  - name: load
    command: python load.py
    depends: [transform]
```

### åœºæ™¯ 3ï¼šå¤æ‚çš„ ETL æµç¨‹

**æŽ¨è**ï¼šAirflow
```python
extract >> transform >> load
```

### åœºæ™¯ 4ï¼šè®¢å•å¤„ç†æµç¨‹

**æŽ¨è**ï¼šTemporal
```go
workflow.ExecuteActivity(ctx, ValidateOrder)
workflow.ExecuteActivity(ctx, ProcessPayment)
workflow.ExecuteActivity(ctx, ShipOrder)
```

---

## æ€»ç»“

**å¯¹äºŽä½ ï¼ˆä¸ªäººå¼€å‘è€…ï¼‰çš„æœ€ä½³é€‰æ‹©ï¼š**

1. **Dagu** - å¦‚æžœéœ€è¦ Web UI å’Œå·¥ä½œæµç¼–æŽ’ â­â­â­â­â­
2. **devtool schedule** - å¦‚æžœåªéœ€è¦ç®€å•å®šæ—¶ä»»åŠ¡ â­â­â­â­â­
3. **Makefile** - å¦‚æžœæ˜¯ä¸´æ—¶çš„å¤šæ­¥éª¤è„šæœ¬ â­â­â­â­

**ä¸æŽ¨è**ï¼š
- âŒ Airflow - å¯¹ä¸ªäººæ¥è¯´å¤ªé‡
- âŒ Temporal - å­¦ä¹ æˆæœ¬å¤ªé«˜

**è¡ŒåŠ¨å»ºè®®**ï¼š
1. å…ˆè¯•è¯• Daguï¼Œçœ‹æ˜¯å¦æ»¡è¶³éœ€æ±‚
2. ç®€å•ä»»åŠ¡ç»§ç»­ç”¨ devtool schedule
3. å¦‚æžœ Dagu ä¸å¤Ÿç”¨ï¼Œå†è€ƒè™‘ Airflow

---

## å¿«é€Ÿå¼€å§‹

### å®‰è£… Dagu
```bash
cd workflow/dagu
./install.sh
```

### å¯åŠ¨ Dagu
```bash
dagu start-all
```

### è®¿é—® Web UI
http://localhost:8080

### åˆ›å»ºç¬¬ä¸€ä¸ªå·¥ä½œæµ
```bash
cat > ~/.dagu/dags/hello.yaml << 'EOF'
name: hello
schedule: "*/5 * * * *"
steps:
  - name: greet
    command: echo "Hello, World!"
EOF
```

å°±è¿™ä¹ˆç®€å•ï¼ðŸŽ‰
